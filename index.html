<!doctype html>

<html lang="en-us">

<head>
  <title>LightBulbOne</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="A description of this site." />
<meta name="author" content="Dean Pucsek" /><link rel="alternate" type="application/rss+xml+xml" href="https://www.lightbulbone.com/index.xml" title="LightBulbOne" /><meta property="og:title" content="LightBulbOne" />
<meta property="og:description" content="A description of this site." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.lightbulbone.com/" />
<meta property="og:updated_time" content="2018-03-25T08:00:00-07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="LightBulbOne"/>
<meta name="twitter:description" content="A description of this site."/>

<meta name="generator" content="Hugo 0.65.3" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://www.lightbulbone.com/fontawesome/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">LightBulbOne</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/lightbulbone" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://twitter.com/lightbulbone" title="Twitter">
               <i class="fab fa-twitter fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>One bright idea after another.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<section id="home">
  <ul>
    
    
    
    <li class="first" >
      <h1><a href="https://www.lightbulbone.com/posts/2018/03/uefi-ninja/" title="UEFI Ninja">UEFI Ninja</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-03-25T08:00:00-07:00">Mar 25, 2018</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/uefi">#UEFI</a>
                
                    , 
                    <a href="/tags/ida">#IDA</a>
                
                    , 
                    <a href="/tags/binary-ninja">#Binary Ninja</a>
                
            </em>
        </li>
        

        <li>12 minutes read</li>
    </ul>
</aside>

      

      <p>As Wikipedia and its own Forum says, UEFI (Unified Extensible Firmware Interface) is a software layer situated between the operating system and platform firmware. It was developed as a replacement for the BIOS and provides an environment where developers can create applications and drivers for use before the operating system is loaded. UEFI is defined as a specification with a corresponding reference implementation named Tianocore.
In order to better understand another target I am reversing it became clear that I needed to learn more about UEFI and reverse some aspects of it.</p>
      
      <a href="/posts/2018/03/uefi-ninja/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2016/10/dsmos-kext/" title="Reversing a macOS Kernel Extension">Reversing a macOS Kernel Extension</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2016-10-11T18:25:50-08:00">Oct 11, 2016</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/kernel">#kernel</a>
                
                    , 
                    <a href="/tags/macos">#macOS</a>
                
                    , 
                    <a href="/tags/lldb">#lldb</a>
                
                    , 
                    <a href="/tags/ida">#IDA</a>
                
            </em>
        </li>
        

        <li>13 minutes read</li>
    </ul>
</aside>

      

      <p>In my last post I covered the basics of kernel debugging in macOS. In this post we will put some of that to use and work through the process of reversing a macOS kernel module.
As I said in my last post, in macOS there is a kernel module named “Don’t Steal Mac OS X” (DSMOS) which registers a function with the Mach-O loader to unpack binaries that have the SG_PROTECTED_VERSION_1 flag set on their __TEXT segment.</p>
      
      <a href="/posts/2016/10/dsmos-kext/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2016/10/intro-to-macos-kernel-debugging/" title="Introduction to macOS Kernel Debugging">Introduction to macOS Kernel Debugging</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2016-10-04T08:30:00-07:00">Oct 4, 2016</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/macos">#macOS</a>
                
                    , 
                    <a href="/tags/kernel">#kernel</a>
                
                    , 
                    <a href="/tags/lldb">#lldb</a>
                
            </em>
        </li>
        

        <li>8 minutes read</li>
    </ul>
</aside>

      

      <p>In macOS there is a kernel module named &ldquo;Don&rsquo;t Steal Mac OS X&rdquo; (DSMOS) which registers a function with the Mach-O loader to unpack binaries that have the SG_PROTECTED_VERSION_1 flag set on their __TEXT segment. Finder, Dock, and loginwindow are a few examples of binaries that have this flag set. As it turns out, this kernel module at one point played a role in the myth that Apple had included a TPM in their Mac hardware.</p>
      
      <a href="/posts/2016/10/intro-to-macos-kernel-debugging/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2015/12/bluetool/" title="Analysis of the iOS Bluetooth Stack: BlueTool">Analysis of the iOS Bluetooth Stack: BlueTool</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2015-12-27T08:30:00-07:00">Dec 27, 2015</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/ios">#iOS</a>
                
            </em>
        </li>
        

        <li>7 minutes read</li>
    </ul>
</aside>

      

      <p>On iOS the Bluetooth stack is split into three layers as shown in Figure 1. At the top is the CoreBluetooth framework used by iOS app developers and at the bottom is the Bluetooth hardware itself. In between these two layers is a collection of daemons that implement various aspects of the Bluetooth stack. For example, most Bluetooth Low Energy (BLE) specific functionality is contained in the BTLEServer daemon. BlueTool is one of the daemons running and is primarily responsible for acting as a bridge between the rest of the Bluetooth stack and the hardware.</p>
      
      <a href="/posts/2015/12/bluetool/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2014/07/ida-processor-options-oops/" title="IDA Processor Options - Oops.">IDA Processor Options - Oops.</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2014-07-21T08:30:00-07:00">Jul 21, 2014</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/ios">#iOS</a>
                
                    , 
                    <a href="/tags/ida">#IDA</a>
                
            </em>
        </li>
        

        <li>One minute read</li>
    </ul>
</aside>

      

      <p>Archive: This post is from an archive which unfortunately did not include images.
 So I&rsquo;ve been working through the LLB code that I talked about in my last article and kept running into incorrectly decoded instructions. I knew they were wrong because (A) the output IDA was giving made no sense and (B) I manually decoded some of them myself to check it.
The problem? I forgot to set the processor options when loading the LLB binary.</p>
      
      <a href="/posts/2014/07/ida-processor-options-oops/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2014/07/reverse-engineering-the-ios-boot-mechanism-part-1/" title="Reverse Engineering the iOS Boot Mechanism: Part 1">Reverse Engineering the iOS Boot Mechanism: Part 1</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2014-07-14T08:30:00-07:00">Jul 14, 2014</time>
        </li>
        

        

        <li>6 minutes read</li>
    </ul>
</aside>

      

      <p>Due to some unforeseen medical issues, my time as an elite athlete adbruptly came to an end a couple months ago and while dealing with those issues I had a lot of free time on my hands. So, naturally I finally got around to reading Mac OS X Internals: A Systems Approach by Amit Singh and Mac OS X and iOS Internals: To the Apple&rsquo;s Core by Johnathan Levin in their entirety.</p>
      
      <a href="/posts/2014/07/reverse-engineering-the-ios-boot-mechanism-part-1/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2013/08/snooping-on-commcenter/" title="Snooping on CommCenter">Snooping on CommCenter</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2013-08-03T08:30:00-07:00">Aug 3, 2013</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/ios">#iOS</a>
                
            </em>
        </li>
        

        <li>2 minutes read</li>
    </ul>
</aside>

      

      <p>CommCenter is a wonderful part of iOS since it is the single point that is responsible for communication between iOS and the baseband. And with the baseband being responsible for controlling the telephony components I wanted to see what CommCenter was telling it.
To do this all you need to do is create a dynamic library with a few functions then shove that in between CommCenter and the baseband. Easy, eh?</p>
      
      <a href="/posts/2013/08/snooping-on-commcenter/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2013/07/ios-shared-cache-extraction/" title="iOS Shared Cache Extraction">iOS Shared Cache Extraction</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2013-07-26T08:30:00-07:00">Jul 26, 2013</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/ios">#iOS</a>
                
            </em>
        </li>
        

        <li>2 minutes read</li>
    </ul>
</aside>

      

      <p>Having fallen off the iOS-exploration train due to completing my Masters and other commitments, I have finally climbed back aboard in pursuit of understanding the telephony stack.
Like most things in iOS that are used frequently, the vast majority of the frameworks and libraries used in the telephony stack reside in the dyld shared cache located at /System/Library/Caches/com.apple.dyld/dyld_shared_cache_armv7.
In this post I am going to explain how to go about extracting this cache file so that you can then work with each library individually.</p>
      
      <a href="/posts/2013/07/ios-shared-cache-extraction/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2013/01/remote-debugging-with-lldb/" title="Remote Debugging With lldb">Remote Debugging With lldb</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2013-01-08T08:30:00-07:00">Jan 8, 2013</time>
        </li>
        

        

        <li>2 minutes read</li>
    </ul>
</aside>

      

      <p>The other day I was working on a project in Xcode and was getting fed up with it crashing and just not behaving. So I set out on a mission to figure out how to remote debug an iOS app. The secret to it all is LLDB, the LLVM Debugger. LLDB is now the default debugger in Xcode (has been for awhile) and is a pretty powerful debugger complete with scripting in Python and many other hidden gems.</p>
      
      <a href="/posts/2013/01/remote-debugging-with-lldb/">Read more…</a>
      
    </li>
    
    <li >
      <h1><a href="https://www.lightbulbone.com/posts/2012/10/fuzzy-ios-messages/" title="Fuzzy iOS Messages!">Fuzzy iOS Messages!</a></h1>
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2012-10-19T08:30:00-07:00">Oct 19, 2012</time>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="/tags/ios">#iOS</a>
                
            </em>
        </li>
        

        <li>2 minutes read</li>
    </ul>
</aside>

      

      <p>Awhile ago I came across a post about fuzzing with a new data flow language called Pythonect. When I read about it I thought it sounded like a pretty nifty language so I decided to try using it to fuzz the iMessage interface in the iOS Messages app.
The first part of this task is to come up with a way to send messages to an iOS device using the iMessage service.</p>
      
      <a href="/posts/2012/10/fuzzy-ios-messages/">Read more…</a>
      
    </li>
    
  </ul>
</section>



</main>
    <footer>
        <h6> |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://www.lightbulbone.comindex.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>

</body>

</html>

